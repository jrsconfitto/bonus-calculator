<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <title>Tangle document</title>

    <!-- Tangle -->
    <script type="text/javascript" src="Tangle.js"></script>

    <!-- TangleKit (optional) -->
    <link rel="stylesheet" href="TangleKit/TangleKit.css" type="text/css">
    <script type="text/javascript" src="TangleKit/mootools.js"></script>
    <script type="text/javascript" src="TangleKit/sprintf.js"></script>
    <script type="text/javascript" src="TangleKit/BVTouchable.js"></script>
    <script type="text/javascript" src="TangleKit/TangleKit.js"></script>
    <script type="text/javascript" src="accounting.js"></script>

    <!-- example -->
    <script type="text/javascript">

        function setUpTangle () {

            var element = document.getElementById("example");

            var taxed = function (subTotal, taxPercentage) {
                return subTotal * taxPercentage / 100
            }

            var afterTax = function(subTotal, taxPercentage) {
                return subTotal - taxed(subTotal, taxPercentage)
            }

            var tangle = new Tangle(element, {
                initialize: function () {
                    this.ssmTaxPercentage = 0.0765 * 100
                    this.incomeTaxPercentage = (0.28 + 0.07) * 100
                    this.bonus = 50
                    this.investments = afterTax(this.bonus, this.ssmTaxPercentage)
                },
                update: function () {
                    this.ssmTaxed = taxed(this.bonus, this.ssmTaxPercentage)
                    this.postSSMTax = afterTax(this.bonus, this.ssmTaxPercentage)
                    this.postSSMTaxDisplay = accounting.formatMoney(this.postSSMTax)

                    this.preInvestmentsTaxed = this.postSSMTax - this.investments
                    this.postInvestmentsTaxed = taxed(this.postSSMTax - this.investments, this.incomeTaxPercentage)
                    this.inPocket = afterTax(this.postSSMTax - this.investments, this.incomeTaxPercentage)
                    this.inPocketDisplay = accounting.formatMoney(this.inPocket)
                }
            });
        }

    </script>
    <style>
        .left {
            float: left;
        }
        .right {
            float: right;
        }
    </style>
</head>

<body onload="setUpTangle();">
    <div id="example">
        <p>This is my bonus calculator.</p>

        <p>
            Let's say your bonus is <span data-var="bonus" class="TKNumberField"> dollars</span>.
        </p>

        <p>
            You entire bonus is taxed at a rate of <span data-var="ssmTaxPercentage" data-format="%.2f"> %</span> for Social Security and Medicare, and you will be left with <span data-var="postSSMTaxDisplay" /> to allocate to investments and your pocket.
        </p>

        <p>
            If you allocate <span class="TKAdjustableNumber" data-var="investments" data-step="25" data-format="%.2f"> to investments</span>, you'll have $<span data-var="preInvestmentsTaxed" data-format="%.2f"> left</span>, and after taxing that amount at a rate of <span data-var="incomeTaxPercentage" data-format="%.0f" class="TKAdjustableNumber">%</span> for federal and state income taxes (which works out to $<span data-var="postInvestmentsTaxed" data-format="%.2f"></span>), you will have <span data-var="inPocketDisplay"> dollars</span> left in your pocket.
        </p>
    </div>

</body>
</html>
